# MySQL 資料庫設置說明

## 1. 安裝 MySQL

如果您還沒有安裝 MySQL，請先安裝：
- **Windows**: 下載並安裝 [MySQL Community Server](https://dev.mysql.com/downloads/mysql/)
- **macOS**: 使用 Homebrew: `brew install mysql`
- **Linux**: `sudo apt-get install mysql-server` (Ubuntu/Debian)

## 2. 創建資料庫

登入 MySQL 後，執行以下命令創建資料庫：

```sql
CREATE DATABASE medical_db CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
```

## 3. 配置環境變數

在專案根目錄創建或編輯 `.env` 文件，添加以下資料庫配置：

```env
# MySQL 資料庫配置
DB_HOST=localhost
DB_USER=root
DB_PASSWORD=您的MySQL密碼
DB_NAME=medical_db

# Gemini API Key (如果還沒有)
GEMINI_API_KEY=您的Gemini_API_Key
```

### 配置說明：
- `DB_HOST`: MySQL 伺服器地址（本地為 `localhost`）
- `DB_USER`: MySQL 使用者名稱（通常為 `root`）
- `DB_PASSWORD`: MySQL 密碼
- `DB_NAME`: 資料庫名稱（預設為 `medical_db`）

## 4. 安裝 Python 依賴

確保已安裝所有必要的套件：

```bash
pip install -r requirements.txt
```

## 5. 自動創建資料表

應用程式啟動時會自動創建 `appointments` 資料表，無需手動創建。

## 6. 測試連接

啟動應用程式後，檢查終端機輸出是否顯示：
```
✅ 資料庫表初始化成功
```

如果出現錯誤訊息，請檢查：
1. MySQL 服務是否正在運行
2. `.env` 文件中的資料庫配置是否正確
3. 資料庫使用者是否有足夠的權限

## 7. 資料表結構

預約表 (`appointments`) 包含以下欄位：
- `id`: 預約編號（自動遞增）
- `username`: 使用者帳號
- `patient_name`: 病患姓名
- `patient_phone`: 聯絡電話
- `department`: 科別
- `doctor_name`: 醫師姓名
- `appointment_date`: 預約日期
- `appointment_time`: 預約時間
- `symptoms`: 症狀描述
- `status`: 預約狀態（pending/confirmed/cancelled）
- `created_at`: 建立時間
- `updated_at`: 更新時間

## 常見問題

### 問題 1: 無法連接到資料庫
**解決方法**：
- 確認 MySQL 服務正在運行
- 檢查 `.env` 文件中的配置是否正確
- 確認 MySQL 使用者有足夠的權限

### 問題 2: 字符編碼問題
**解決方法**：
- 確保資料庫使用 `utf8mb4` 字符集
- 檢查連接字串中是否包含 `charset=utf8mb4`

### 問題 3: 表創建失敗
**解決方法**：
- 確認資料庫使用者有 CREATE TABLE 權限
- 檢查資料庫是否已存在
- 查看終端機的詳細錯誤訊息

