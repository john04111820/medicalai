# AI 預約功能使用說明

## 功能概述

AI 助理現在可以通過對話進行以下操作：
1. **查詢預約記錄** - 詢問您的預約資訊
2. **創建預約** - 通過對話預約門診
3. **修改預約** - 更新現有預約資料

所有操作都會自動將資料存入資料庫。

## 使用方式

### 1. 查詢預約記錄

您可以這樣詢問：

**範例：**
- 「我的預約記錄是什麼？」
- 「查詢病歷號 P12345 的預約」
- 「我想知道張三的預約時間」
- 「查詢電話 0912345678 的預約」

AI 會自動：
- 識別查詢意圖
- 從資料庫中查找相關預約
- 用繁體中文回覆預約詳情

### 2. 創建預約

您可以通過對話創建預約，AI 會自動提取資訊。

**範例對話：**

**方式一：一次性提供所有資訊**
```
用戶：「我要預約內科，病患姓名是張三，電話是 0912345678，醫師是李醫師，日期是明天，時間是 10:00」
AI：「好的，我已經為您創建預約...」
```

**方式二：逐步提供資訊**
```
用戶：「我想預約門診」
AI：「好的，請告訴我病患的姓名、電話、科別、醫師、日期和時間」
用戶：「病患是張三，電話 0912345678」
AI：「好的，請問要預約哪個科別？」
...
```

**可提取的資訊：**
- 病歷號：如「病歷號 P12345」或「P12345」
- 病患姓名：如「姓名：張三」或「病患：張三」
- 聯絡電話：如「電話：0912345678」
- 科別：內科、外科、兒科、婦產科、骨科、眼科、耳鼻喉科、皮膚科、精神科、復健科
- 醫師姓名：如「李醫師」或「醫師：李小明」
- 預約日期：支援多種格式
  - 「2025-12-10」
  - 「12月10日」
  - 「12/10」
  - 「明天」、「後天」、「大後天」
- 預約時間：如「10:00」或「10點」
- 症狀描述：如「症狀：頭痛」

### 3. 修改預約

您可以通過對話修改現有預約。

**範例：**

**方式一：指定病歷號或姓名**
```
用戶：「我要修改病歷號 P12345 的預約，日期改為後天，時間改為 14:00」
AI：「好的，我已經為您更新預約...」
```

**方式二：指定電話**
```
用戶：「修改電話 0912345678 的預約時間為明天下午 3 點」
AI：「好的，我已經為您更新預約...」
```

**可修改的欄位：**
- 病歷號
- 病患姓名
- 聯絡電話
- 科別
- 醫師姓名
- 預約日期
- 預約時間
- 症狀描述
- 預約狀態

## 智能識別功能

AI 會自動識別您的意圖：

### 創建預約關鍵字
- 「預約」、「掛號」、「我要預約」、「幫我預約」、「預約門診」、「我要掛號」

### 修改預約關鍵字
- 「修改」、「更改」、「改」、「更新」、「調整」、「變更」

### 查詢預約關鍵字
- 「查詢」、「我的預約」、「預約記錄」、「查看」、「查」

## 注意事項

1. **必填欄位**：創建預約時，以下欄位為必填：
   - 病患姓名
   - 聯絡電話
   - 科別
   - 醫師姓名
   - 預約日期
   - 預約時間

2. **日期限制**：預約日期必須是未來日期，不能是過去時間

3. **資訊提取**：如果資訊不完整，AI 會友善地詢問缺少的資訊

4. **權限控制**：只能查詢、創建和修改屬於當前登入用戶的預約

5. **資料驗證**：所有資料在存入資料庫前都會進行驗證

## 使用技巧

1. **提供完整資訊**：一次性提供所有資訊可以更快完成預約

2. **使用明確格式**：使用「姓名：XXX」、「電話：XXX」等格式可以幫助 AI 更準確提取資訊

3. **確認資訊**：AI 創建或修改預約後，會提供確認資訊，請仔細檢查

4. **查詢預約**：如果不確定預約詳情，可以先查詢預約記錄

## 範例對話

### 完整預約流程

```
用戶：「我要預約內科門診」
AI：「好的，請告訴我以下資訊：病患姓名、聯絡電話、醫師姓名、預約日期和時間」

用戶：「病患是張三，電話 0912345678，醫師是李醫師，明天上午 10 點」
AI：「好的，我已經為您創建預約。預約編號：1，病患：張三，科別：內科，醫師：李醫師，日期：2025-12-07，時間：10:00。預約狀態：待確認」
```

### 修改預約流程

```
用戶：「我想修改張三的預約，時間改為下午 2 點」
AI：「好的，我已經為您更新預約。張三的預約時間已改為 14:00」
```

### 查詢預約流程

```
用戶：「我的預約記錄是什麼？」
AI：「以下是您的預約記錄：
預約 1 (ID: 1):
  病歷號: P12345
  病患姓名: 張三
  聯絡電話: 0912345678
  科別: 內科
  醫師: 李醫師
  預約日期: 2025-12-07
  預約時間: 10:00
  狀態: pending」
```

## 技術說明

- 所有預約資料都會存入資料庫（SQLite 或 MySQL）
- AI 使用自然語言處理提取預約資訊
- 支援多種日期和時間格式
- 自動驗證資料完整性
- 提供友善的錯誤提示

